import streamlit as st
import datetime
import random

# =========================
# é­‚è¯ï¼ˆã“ã‚“ã‹ï¼‰ã‚¢ã‚µã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
# =========================
def get_zodiac_sign(month, day):
    if (month == 3 and day >= 21) or (month == 4 and day <= 19):
        return 'ç‰¡ç¾Šåº§'
    elif (month == 4 and day >= 20) or (month == 5 and day <= 20):
        return 'ç‰¡ç‰›åº§'
    elif (month == 5 and day >= 21) or (month == 6 and day <= 20):
        return 'åŒå­åº§'
    elif (month == 6 and day >= 21) or (month == 7 and day <= 22):
        return 'èŸ¹åº§'
    elif (month == 7 and day >= 23) or (month == 8 and day <= 22):
        return 'ç…å­åº§'
    elif (month == 8 and day >= 23) or (month == 9 and day <= 22):
        return 'ä¹™å¥³åº§'
    elif (month == 9 and day >= 23) or (month == 10 and day <= 22):
        return 'å¤©ç§¤åº§'
    elif (month == 10 and day >= 23) or (month == 11 and day <= 21):
        return 'è åº§'
    elif (month == 11 and day >= 22) or (month == 12 and day <= 21):
        return 'å°„æ‰‹åº§'
    elif (month == 12 and day >= 22) or (month == 1 and day <= 19):
        return 'å±±ç¾Šåº§'
    elif (month == 1 and day >= 20) or (month == 2 and day <= 18):
        return 'æ°´ç“¶åº§'
    elif (month == 2 and day >= 19) or (month == 3 and day <= 20):
        return 'é­šåº§'

def assign_konka(zodiac):
    mapping = {
        'ç‰¡ç¾Šåº§': 'ç„”è¯ï¼ˆãˆã‚“ã‹ / Ignisï¼‰',
        'ç‰¡ç‰›åº§': 'æ ¹è¯ï¼ˆã“ã‚“ã‹ / Terraï¼‰',
        'åŒå­åº§': 'é¢¨è¯ï¼ˆãµã†ã‹ / Aerisï¼‰',
        'èŸ¹åº§': 'æ¾„è¯ï¼ˆã¡ã‚‡ã†ã‹ / Aquaï¼‰',
        'ç…å­åº§': 'å…‰è¯ï¼ˆã“ã†ã‹ / Lucisï¼‰',
        'ä¹™å¥³åº§': 'å‘½è¯ï¼ˆã¿ã‚‡ã†ã‹ / Vitaeï¼‰',
        'å¤©ç§¤åº§': 'é¢¨è¯ï¼ˆãµã†ã‹ / Aerisï¼‰',
        'è åº§': 'é—‡è¯ï¼ˆã‚ã‚“ã‹ / Umbraï¼‰',
        'å°„æ‰‹åº§': 'é­‚è¯ï¼ˆã“ã‚“ã‹ / Konkaï¼‰',
        'å±±ç¾Šåº§': 'æ ¹è¯ï¼ˆã“ã‚“ã‹ / Terraï¼‰',
        'æ°´ç“¶åº§': 'ç©ºè¯ï¼ˆãã†ã‹ / Caelumï¼‰',
        'é­šåº§': 'æ¾„è¯ï¼ˆã¡ã‚‡ã†ã‹ / Aquaï¼‰',
    }
    return mapping.get(zodiac, 'é­‚è¯ï¼ˆã“ã‚“ã‹ / Konkaï¼‰')

# =========================
# Streamlit ã‚¢ãƒ—ãƒªæœ¬ä½“
# =========================
st.title("ğŸŒ¸ ä¹è¯ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°")
st.caption("Produced by å®®ä¸‹ãƒã‚¢")

name = st.text_input("ğŸ§š ãŠåå‰ï¼ˆãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ å¯ï¼‰")
birth_date = st.date_input("ğŸ‚ ç”Ÿå¹´æœˆæ—¥ã‚’é¸æŠ", min_value=datetime.date(1900, 1, 1))
question = st.text_area("ğŸ”® ä»Šã€çŸ¥ã‚ŠãŸã„ã“ã¨ãƒ»ãƒ†ãƒ¼ãƒï¼ˆä»»æ„ï¼‰")

if st.button("âœ¨ ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å§‹ã‚ã‚‹") and name and birth_date:
    month, day = birth_date.month, birth_date.day
    zodiac = get_zodiac_sign(month, day)
    konkah = assign_konka(zodiac)

    # ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆã‚¨ãƒªã‚¢
    lucky_color = random.choice(["ãƒ­ãƒ¼ã‚ºã‚´ãƒ¼ãƒ«ãƒ‰", "ã‚»ãƒ¼ã‚¸ã‚°ãƒªãƒ¼ãƒ³", "ã‚¢ã‚¤ã‚¹ãƒ–ãƒ«ãƒ¼", "ãƒŸãƒƒãƒ‰ãƒŠã‚¤ãƒˆãƒã‚¤ãƒ“ãƒ¼"])
    lucky_food = random.choice(["é…µç´ ãŸã£ã·ã‚Šã‚¹ãƒ ãƒ¼ã‚¸ãƒ¼", "å¡©éº¹å…¥ã‚Šã‚¹ãƒ¼ãƒ—", "é»’ã”ã¾å›£å­", "æœˆè¦‹ã ã‚“ã”"])
    lucky_direction = random.choice(["æ±åŒ—æ±", "å—å—è¥¿", "è¥¿", "åŒ—æ±"])
    moon_phase = random.choice(["æ–°æœˆ", "ä¸Šå¼¦ã®æœˆ", "æº€æœˆ", "ä¸‹å¼¦ã®æœˆ"])
    best_transfer_time = random.choice(["æ¥æœˆä¸­æ—¬", "æ¬¡ã®æº€æœˆå¾Œ", "ç§‹åˆ†å‰å¾Œ", "ä»Šã™ãæº–å‚™ã‚’å§‹ã‚ã¦â—"])
    lucky_underwear = random.choice(["ç™½Ã—ãƒ¬ãƒ¼ã‚¹ï¼ˆæŸ”ã‚‰ã‹ãªå®ˆã‚Šï¼‰", "èµ¤ç³»ï¼ˆæƒ…ç†±UPï¼‰", "ãƒã‚¤ãƒ“ãƒ¼ï¼ˆé›†ä¸­åŠ›UPï¼‰"])
    lucky_pet_style = random.choice(["çŒ«ã®ã‚ˆã†ãªè‡ªç”±ãªä»˜ãåˆã„", "çŠ¬ã®ã‚ˆã†ãªå¿ èª é–¢ä¿‚", "å°å‹•ç‰©ã®ã‚ˆã†ãªç™’ã—ç³»äº¤æµ"])
    lucky_plant_attunement = random.choice(["æ¯æœãƒãƒ¼ãƒ–ã«èªã‚Šã‹ã‘ã‚‹", "è¦³è‘‰æ¤ç‰©ã¨ãƒªã‚ºãƒ ã‚’åˆã‚ã›ã‚‹", "èŠ±ã‚’é£¾ã‚Šæ°´ã‚’æ›¿ãˆã‚‹ç‘æƒ³"])
    lucky_shrine = random.choice(["å‡ºé›²å¤§ç¤¾ï¼ˆç¸çµã³ï¼‰", "ä¼Šå‹¢ç¥å®®ï¼ˆå†…é¢ã®æµ„åŒ–ï¼‰", "æ—¥å…‰æ±ç…§å®®ï¼ˆå‹è² é‹UPï¼‰"])
    shrine_time = random.choice(["åˆå‰7ã€œ9æ™‚ï¼ˆæ¸…æµ„ï¼‰", "å¤•æ–¹4æ™‚å‰å¾Œï¼ˆé™å¯‚ï¼‰"])
    shrine_dress = random.choice(["ç™½ or ãƒ©ãƒ™ãƒ³ãƒ€ãƒ¼è‰²ã®æœ", "å’Œè£… + æœ¨ã®å°ç‰©"])

    st.markdown(f"""
    ---
    ## ğŸŒŸ {name} ã•ã‚“ã® ä¹è¯ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çµæœ ğŸŒŸ

    - ğŸ—“ ç”Ÿå¹´æœˆæ—¥: `{birth_date}`
    - ğŸ”­ å¤ªé™½æ˜Ÿåº§ï¼š**{zodiac}**
    - ğŸŒ¸ å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸé­‚è¯ï¼š**{konkah}**
    - ğŸŒ• ç¾åœ¨ã®æœˆç›¸ï¼š**{moon_phase}**

    ---
    ### ğŸ”® é–‹é‹ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

    - ğŸ’¼ **è»¢è·ã«æœ€é©ãªæ™‚æœŸ**ï¼š{best_transfer_time}
    - ğŸ’ ãƒ©ãƒƒã‚­ãƒ¼ã‚«ãƒ©ãƒ¼ï¼š{lucky_color}
    - ğŸ½ï¸ ãƒ©ãƒƒã‚­ãƒ¼ãƒ•ãƒ¼ãƒ‰ï¼š{lucky_food}
    - ğŸ“ å‰æ–¹ä½ï¼š{lucky_direction}
    - ğŸ‘™ ä¸‹ç€ã®ãŠã™ã™ã‚ï¼š{lucky_underwear}

    ---
    ### ğŸ›• å‚æ‹ã‚¢ãƒ‰ãƒã‚¤ã‚¹

    - ã”ç¸ã‚ã‚‹ç¥ç¤¾ï¼š**{lucky_shrine}**
    - æœ€é©æ™‚æœŸï¼š**æ¬¡ã® {moon_phase} å‰å¾Œ**
    - æ¨å¥¨æ™‚é–“å¸¯ï¼š{shrine_time}
    - æœè£…ï¼†æŒã¡ç‰©ï¼š{shrine_dress}ï¼ˆé¦™ã‚Šã‚ã‚‹ã‚¢ã‚¤ãƒ†ãƒ æ¨å¥¨ï¼‰

    ---
    ### ğŸŒ± è‡ªç„¶ã¨ã®é–¢ä¿‚æ€§

    - ğŸŒ¿ æ¤ç‰©ã¨ã®ä»˜ãåˆã„æ–¹ï¼š{lucky_plant_attunement}
    - ğŸ¾ å‹•ç‰©ã¨ã®è·é›¢æ„Ÿï¼š{lucky_pet_style}

    ---
    ### ğŸ’– æ‹æ„›ãƒ»é­…åŠ›é–‹èŠ±

    - é­…åŠ›UPè¡Œå‹•ï¼š**é¦™ã‚Šãƒ»éŸ³ãƒ»è‰²**ã‚’æ„è­˜ã—ã¦ç”Ÿæ´»ã«å–ã‚Šå…¥ã‚Œã¦
    - å‹è² ã®æ—¥ã®è¡Œå‹•ï¼š**ç›´æ„Ÿã«å¾“ã„ã€å¤§èƒ†ã«1æ­©ã‚’è¸ã¿å‡ºã™**

    ---
    ### ğŸ’° é‡‘é‹ã‚¢ãƒ‰ãƒã‚¤ã‚¹

    - ä»Šã¯ã€Œ{random.choice(['ãŠé‡‘ã®çŸ¥è­˜ã‚’å­¦ã¶ã®ã«æœ€é©ãªæ™‚æœŸ', 'ç›´æ„Ÿçš„ãªãŠé‡‘ã®ä½¿ã„æ–¹ã«æ³¨æ„ã™ã‚‹æ™‚æœŸ'])}ã€ã§ã™ã€‚
    - å­¦ã¶ã¨è‰¯ã„ã‚¸ãƒ£ãƒ³ãƒ«ï¼š**æŠ•è³‡ãƒ»ä¾¡å€¤è¦³æ•´ç†ãƒ»è±Šã‹ã•ãƒã‚¤ãƒ³ãƒ‰**

    ---
    ### ğŸª å®‡å®™ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

    ã”è³ªå•ï¼šã€Œ{question if question else 'ç‰¹ã«ãªã—'}ã€
    > ä»Šã®ã‚ãªãŸã«å¿…è¦ãªã®ã¯ã€Œ**ä½™ç™½**ã€ã¨ã€Œ**æ„Ÿæ€§ã®æ‹¡å¼µ**ã€ã€‚é™ã‹ã«å®‡å®™ã®ã‚µã‚¤ãƒ³ã‚’å—ã‘å–ã‚‹æ™‚é–“ã‚’ç¢ºä¿ã—ã¾ã—ã‚‡ã†ã€‚

    """)

    st.caption("Â©ï¸ 2025 ä¹è¯ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚° - Neo Cosmique Edition")
